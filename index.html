<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>سجل المصاريف التشغيلية اليومية</title>

  <style>
    :root{
      --brown:#4B2C10;
      --brown-2:#3A220C;
      --gold:#D4A33A;
      --ink:#0f172a;
      --muted:#475569;
      --paper:#ffffff;
      --bg1:#FFF7ED;
      --bg2:#FFFBF5;
      --line:#E7D7C9;
      --line2:#D7C2AF;
      --head:#FFF3E0;
      --head2:#FFE7C2;
      --shadow: 0 10px 28px rgba(2, 6, 23, .10);
      --radius:16px;
    }

    *{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    
    body{
      margin:0;
      font-family: Tahoma, Arial, sans-serif;
      font-size:16px; 
      color:var(--ink);
      background: linear-gradient(180deg, var(--bg1) 0%, var(--bg2) 100%);
      line-height: 1.5;
    }

    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding:10px;
    }

    .page{
      background:var(--paper);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:15px;
      overflow:hidden;
    }

    .headerLogo{
      display:flex;
      justify-content:center;
      margin-bottom:15px;
    }

    .logoBox{
      width:100%;
      max-width:280px;
      height:120px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
    }

    #logoImg{
      width:100%;
      height:100%;
      object-fit:contain;
    }

    h1{
      margin:10px 0 20px;
      text-align:center;
      font-size:1.4rem;
      color: var(--brown);
    }

    /* تحسين الجدول العلوي للجوال */
    .meta {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .meta tr {
      display: flex;
      flex-wrap: wrap;
      border: 1px solid var(--line);
      margin-bottom: 10px;
      border-radius: 10px;
      overflow: hidden;
    }

    .meta th, .meta td {
      flex: 1 1 50%; /* يأخذ نصف العرض في الجوال */
      padding: 12px;
      border: none;
      border-bottom: 1px solid var(--line);
      font-size: 14px;
    }

    .meta th {
      background: var(--head);
      text-align: right;
      color: var(--brown);
    }

    .meta td[colspan="3"] {
      flex: 1 1 100%;
    }

    /* تحسين أزرار التحكم */
    .actions {
      margin-bottom: 15px;
    }

    .btns {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    button {
      padding: 12px;
      border-radius: 10px;
      font-weight: bold;
      font-size: 15px;
      border: 1px solid var(--line2);
      cursor: pointer;
    }

    button.primary { background: var(--brown); color: #fff; }
    button.danger { background: #fee2e2; color: #b91c1c; border-color: #fecaca; }

    /* جعل جدول المصاريف قابلاً للتمرير على الشاشات الصغيرة */
    .table-container {
      width: 100%;
      overflow-x: auto;
      border: 1px solid var(--line);
      border-radius: 12px;
      -webkit-overflow-scrolling: touch;
    }

    table.sheet {
      width: 100%;
      min-width: 500px; /* يمنع انضغاط الجدول بشدة */
      border-collapse: collapse;
    }

    .sheet th, .sheet td {
      padding: 12px 8px;
      border-bottom: 1px solid var(--line);
      border-left: 1px solid var(--line);
    }

    .col-num { width: 45px; text-align: center; }
    .col-amt { width: 120px; }

    input[type="text"], input[type="number"], input[type="date"] {
      padding: 8px;
      border: 1px solid var(--line2);
      border-radius: 8px;
      font-size: 15px;
      width: 100%;
    }

    .totalLine {
      margin-top: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--head);
      padding: 15px;
      border-radius: 12px;
    }

    .totalValue {
      font-weight: 900;
      font-size: 1.2rem;
      color: var(--brown);
    }

    /* تعديلات الشاشات الكبيرة (الكمبيوتر) */
    @media (min-width: 768px) {
      .meta tr { display: table-row; }
      .meta th, .meta td { display: table-cell; border: 1px solid var(--line); }
      .btns { display: flex; }
      button { padding: 10px 20px; width: auto; }
      h1 { font-size: 1.8rem; }
    }

    @media print {
      .actions, #logoInput { display: none !important; }
      body { background: white; }
      .page { box-shadow: none; border: none; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="page">
      
      <div class="headerLogo">
        <div class="logoBox" id="logoBox">
          <img id="logoImg" alt="شعار الشركة" src="https://www.genspark.ai/api/files/s/N7eKy1mf" />
          <input id="logoInput" type="file" accept="image/*" style="display:none" />
        </div>
      </div>

      <h1>سجل المصاريف التشغيلية</h1>

      <table class="meta">
        <tr>
          <th>من تاريخ</th>
          <td><input id="startDate" type="date" /></td>
          <th>إلى تاريخ</th>
          <td><input id="endDate" type="date" /></td>
        </tr>
        <tr>
          <th>اسم القروب</th>
          <td colspan="3"><input id="groupName" type="text" /></td>
        </tr>
        <tr>
          <th>عدد القروب</th>
          <td><input id="groupCount" type="number" inputmode="numeric" /></td>
          <th>المسؤول</th>
          <td><input id="groupSupervisor" type="text" /></td>
        </tr>
      </table>

      <div class="actions">
        <div class="btns">
          <button class="primary" id="addRowBtn">+ إضافة</button>
          <button class="danger" id="removeRowBtn">حذف</button>
        </div>
      </div>

      <div class="table-container">
        <table class="sheet" id="expensesTable">
          <thead>
            <tr>
              <th class="col-num">#</th>
              <th>الوصف</th>
              <th class="col-amt">المبلغ</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>

      <div class="totalLine">
        <div class="totalLabel">الإجمالي المشتمل:</div>
        <div class="totalValue" id="totalValue">0.00</div>
      </div>

    </div>
  </div>

  <script>
    const tbody = document.getElementById('tbody');
    const totalValueEl = document.getElementById('totalValue');

    function recalcTotal(){
      let sum = 0;
      document.querySelectorAll('.amtInput').forEach(inp => {
        sum += parseFloat(inp.value) || 0;
      });
      totalValueEl.textContent = sum.toLocaleString('en-US', {minimumFractionDigits: 2});
    }

    function addRow(){
      const rowCount = tbody.rows.length + 1;
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td class="col-num">${rowCount}</td>
        <td><input type="text" class="descInput"></td>
        <td class="col-amt"><input type="number" step="0.01" inputmode="decimal" class="amtInput"></td>
      `;
      tbody.appendChild(tr);
      tr.querySelector('.amtInput').addEventListener('input', recalcTotal);
    }

    function removeLastRow(){
      if(tbody.rows.length > 0) {
        tbody.deleteRow(-1);
        recalcTotal();
      }
    }

    // إضافة 5 صفوف افتراضية عند التشغيل
    for(let i=0; i<5; i++) addRow();

    document.getElementById('addRowBtn').addEventListener('click', addRow);
    document.getElementById('removeRowBtn').addEventListener('click', removeLastRow);
    
    // تغيير الشعار
    const logoBox = document.getElementById('logoBox');
    const logoInput = document.getElementById('logoInput');
    logoBox.addEventListener('click', () => logoInput.click());
    logoInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if(file){
        const reader = new FileReader();
        reader.onload = (ev) => document.getElementById('logoImg').src = ev.target.result;
        reader.readAsDataURL(file);
      }
    });
  </script>
</body>
</html>
